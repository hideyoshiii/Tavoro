<div class="bar_collection">
	<div class="bar_smoke"></div>	
	<div style="width:100%;">
		<div class="pro29">
			<a href="" data-toggle="modal" data-target="#myModal_profile_<%= @user.id %>">
				<div style="padding:10px 10px 10px 20px;display:inline-block;vertical-align:middle;">
        			<%= image_tag @user.image(:large), :class =>'img_user11' %>
        		</div>
				<div class="font_white" style="display:inline-block;vertical-align:middle;max-width:50%;word-wrap: break-word;">
        			<%= @user.name %>
        			<% if @user.authority == "public" %>
                      <%= image_tag "test55.png", :style =>'width:14px;height:14px;' %>
                    <% end %>
        		</div>
    		</a>
		</div>
		<div class="pro30">
			<div style="width:100%;text-align:right;"> 	
				<div id="checked" class="btn_on" style="display:inline-block;vertical-align:middle;">
					<%= image_tag "checked.png", :style =>'width:12px;height:12px;margin-top:-2px;' %>
					<span style="color:#c2c2c2;"><%= @checkeds_i %></span> 
				</div>
				<div id="bookmark" class="btn_off" style="display:inline-block;vertical-align:middle;margin-right:10px;">
					<%= image_tag "bookmark.png", :style =>'width:12px;height:12px;margin-top:-2px;' %>
					<span style="color:#c2c2c2;"><%= @bookmarks_i %></span>
				</div>				
			</div>  
		</div>
	</div>		      
	<div class="tabContainer">
        <div class="tab_table">
            <div class="tab__button active">すべて</div>
            <div class="tab__button">映画</div>
            <div class="tab__button">テレビ</div>
            <div class="tab__button">ブック</div>
            <div class="tab__button">コミック</div>
            <div class="tab__button">ミュージック</div>
        </div>
    </div>
</div>

<div class="main">
	<div class="cover"></div>
	<div class="block_side">
	</div>
	<div class="block_main">

		<div class="swiper-container" style="height:100%">
			<div class="swiper-wrapper" style="height:100%">

				<div class="swiper-slide" style="height:100%">
		        	<div class="checked" id="ggg" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
					  	<% if @checkeds.blank? %>
					  		<%= render "partial/nothing" %>
					  	<% else %>
						  	<% @checkeds.each.with_index(1) do |post, i| %>
					  			<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing01.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<% if post.category == "music" %>
												<img data-src="<%= post.image_url %>" class="img_lavoro000 lazyload">
											<% else %>
												<img data-src="<%= post.image_url %>" class="img_lavoro001 lazyload">
											<% end %>
										<% end %>
										<span>
											<div class="font_category_min">
												<% if post.category == "movie" %>
													<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> 映画
												<% end %>
												<% if post.category == "tv" %>
													<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> テレビ
												<% end %>
												<% if post.category == "book" %>
													<%= image_tag "book_gray.png", :class =>'icon_category_min' %> ブック
												<% end %>
												<% if post.category == "comic" %>
													<%= image_tag "book_gray.png", :class =>'icon_category_min' %> コミック
												<% end %>
												<% if post.category == "music" %>
													<%= image_tag "music_gray.png", :class =>'icon_category_min' %> ミュージック
												<% end %>
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
				  	</div>
				  	<div class="bookmark hide" id="hhh" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
				  		<% if @bookmarks.blank? %>
					  		<%= render "partial/nothing" %>
					  	<% else %>
						  	<% @bookmarks.each.with_index(1) do |post, i| %>
					  			<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing01.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<% if post.category == "music" %>
												<img  data-src="<%= post.image_url %>" class="img_lavoro000 lazyload">
											<% else %>
												<img data-src="<%= post.image_url %>" class="img_lavoro001 lazyload">
											<% end %>
										<% end %>
										<span>
											<div class="font_category_min">
												<% if post.category == "movie" %>
													<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> 映画
												<% end %>
												<% if post.category == "tv" %>
													<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> テレビ
												<% end %>
												<% if post.category == "book" %>
													<%= image_tag "book_gray.png", :class =>'icon_category_min' %> ブック
												<% end %>
												<% if post.category == "comic" %>
													<%= image_tag "book_gray.png", :class =>'icon_category_min' %> コミック
												<% end %>
												<% if post.category == "music" %>
													<%= image_tag "music_gray.png", :class =>'icon_category_min' %> ミュージック
												<% end %>
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
				  	</div>
		        </div>

		        <div class="swiper-slide" style="height:100%">
		        	<div class="checked" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
					  	<% if @checkeds_movie.blank? %>
					  		<%= render "partial/nothing" %>
					  	<% else %>
						    <% @checkeds_movie.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing01.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> 映画
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
					</div>
				  	<div class="bookmark hide" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
				  		<% if @bookmarks_movie.blank? %>
					  		<%= render "partial/nothing02" %>
					  	<% else %>
						    <% @bookmarks_movie.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing01.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> 映画
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
				  	</div>
		        </div>

		        <div class="swiper-slide" style="height:100%">
		        	<div class="checked" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
					    <% if @checkeds_tv.blank? %>
					  		<%= render "partial/nothing" %>
					  	<% else %>
						  	<% @checkeds_tv.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing01.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> テレビ
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
					</div>
				  	<div class="bookmark hide" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
				  		<% if @bookmarks_tv.blank? %>
					  		<%= render "partial/nothing02" %>
					  	<% else %>
						  	<% @bookmarks_tv.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing01.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "movie_gray.png", :class =>'icon_category_min' %> テレビ
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
				  	</div>
		        </div>

		        <div class="swiper-slide" style="height:100%">
		        	<div class="checked" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
					    <% if @checkeds_book.blank? %>
					  		<%= render "partial/nothing" %>
					  	<% else %>
						  	<% @checkeds_book.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing02.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">										
												<%= image_tag "book_gray.png", :class =>'icon_category_min' %> ブック
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
					</div>
				  	<div class="bookmark hide" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
				  		<% if @bookmarks_book.blank? %>
					  		<%= render "partial/nothing02" %>
					  	<% else %>
						  	<% @bookmarks_book.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing02.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">										
												<%= image_tag "book_gray.png", :class =>'icon_category_min' %> ブック
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
					  	<% end %>
				  	</div>
		        </div>

		        <div class="swiper-slide" style="height:100%">
		        	<div class="checked" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
					    <% if @checkeds_comic.blank? %>
					  		<%= render "partial/nothing" %>
					  	<% else %>
						  	<% @checkeds_comic.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing02.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "book_gray.png", :class =>'icon_category_min' %> コミック
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
				  		<% end %>
				  	</div>
				  	<div class="bookmark hide" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
				  		<% if @bookmarks_comic.blank? %>
					  		<%= render "partial/nothing02" %>
					  	<% else %>
						  	<% @bookmarks_comic.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing02.jpg" class="swiper-lazy img_lavoro001">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro001">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "book_gray.png", :class =>'icon_category_min' %> コミック
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>
						  	<% end %>
				  		<% end %>
		  			</div>
		        </div>

		        <div class="swiper-slide" style="height:100%">
		        	<div class="checked" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
					    <% if @checkeds_music.blank? %>
					  		<%= render "partial/nothing" %>
					  	<% else %>
						  	<% @checkeds_music.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing03.jpg" class="swiper-lazy img_lavoro000">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro000">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "music_gray.png", :class =>'icon_category_min' %> ミュージック
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>	  		
						  	<% end %>
					  	<% end %>
					</div>
				  	<div class="bookmark hide" style="height:100%;overflow-y:scroll;-webkit-overflow-scrolling: touch;">
				  		<div style="height:165px;"></div>
				  		<% if @bookmarks_music.blank? %>
					  		<%= render "partial/nothing02" %>
					  	<% else %>
						  	<% @bookmarks_music.each.with_index(1) do |post, i| %>
						  		<div class="<%= 'test_radio_right' if i % 3 == 0 %> <%= 'test_radio' if i % 3 != 0 %>">
							    	<a href="" data-toggle="modal" data-target="#myModal_<%= post.id %>">
										<% if post.image_url.blank? %>
											<img data-src="nothing03.jpg" class="swiper-lazy img_lavoro000">
										<% else %>
											<img data-src="<%= post.image_url %>" class="swiper-lazy img_lavoro000">
										<% end %>
										<span>
											<div class="font_category_min">
												<%= image_tag "music_gray.png", :class =>'icon_category_min' %> ミュージック
											</div>
											<div class="contain_title">
												<div class="font_title_min">
													<%= post.title %>
												</div>
											</div>
										</span>
									</a>
								</div>	  		
						  	<% end %>
					  	<% end %>
				  	</div>
		        </div>

			</div>
		</div>
		
	</div>
	<div class="block_side">
	</div>
</div>




<%#プロフィールモーダル%>
<%= render partial: 'users/profile', locals: { user: @user, checkeds_i: @checkeds_i, bookmarks_i: @bookmarks_i } %>

<%#投稿ボタン%>
<%= render "partial/post_modal" %>


<%#タブ切り替え%>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.4.1/js/swiper.min.js"></script>
<script type="text/javascript">
	$(function(){
    /******************************************
    事前準備
    *******************************************/
    //タブボタンの数を取得
    var tabQuantity = $('.tab__button').length;
    //タブの長さとボディの長さの差分を取得
    var tabExtraDistance = $('.tab_table').width();
    /******************************************
    スライダー発動
    *******************************************/
    var swiper = new Swiper('.swiper-container', {
			speed: 600,
			touchAngle: 55,
			preloadImages: false,
			lazy: {
				loadOnTransitionStart: true,
				loadPrevNext: false,
			},
		  	on: {
			    slideChange: function () {
			      var newIndex = swiper.realIndex;
            	  slideChange(newIndex);
			    },
			  },
		});
    /******************************************
    スライドする時に発動する関数。タブの表示調整を行う。
    *******************************************/
    function slideChange(newIndex){
        //クラスを調整
        $('.tab__button').removeClass('active');
        $('.tab_table > div:nth-child(' + ( newIndex + 1 ) + ')').addClass('active');
        //スクロールするべき距離を取得。タブ全体の長さ / ( タブの個数 - 1 ) * スライドの現在地
        var scrollDestination = ( tabExtraDistance / (tabQuantity - 1) ) * ( newIndex );
        //スクロール位置を調整
        $('.tabContainer').animate({ scrollLeft: scrollDestination }, 'slow');
    }
    /******************************************
    タブボタンクリックで発動する関数
    *******************************************/
    $('.tab__button').on('click',function(e){
        //何番目の要素かを取ってスライドを移動する
        var nth = $('.tab__button').index(this);
        swiper.slideTo(nth, 500, false);
        //クリックイベントを無効化
        e.preventDefault();
    })
});
</script>


<%#ブックマーク切り替え%>
<script type="text/javascript">
	$(function(){
    $('#checked').click(function(){
    	$('#checked').addClass("btn_on");
    	$('#checked').removeClass("btn_off");
    	$('#bookmark').addClass("btn_off");
    	$('#bookmark').removeClass("btn_on");
        $('.checked').removeClass("hide");
        $('.bookmark').addClass("hide");
    });
    $('#bookmark').click(function(){
    	$('#bookmark').addClass("btn_on");
    	$('#bookmark').removeClass("btn_off");
    	$('#checked').addClass("btn_off");
    	$('#checked').removeClass("btn_on");
        $('.bookmark').removeClass("hide");
        $('.checked').addClass("hide");
    });
});
</script>


<%#ハーフモーダル%>
<script type="text/javascript">
  $(function(){
  	//overlayを削除
  	if ($('div').hasClass("pushbar_overlay")) {
	  var Back = document.querySelector('html');
	  Back.classList.remove('pushbar_locked');
	  Back.removeAttribute('pushbar');
	}
	//ハーフモーダルを削除
	if ($('.opened').hasClass("opened")) {
	  var Bar = document.querySelector('.opened');
	  Bar.classList.remove('opened');
	}
  	//ハーフモーダル生成
  	var pushbar = new Pushbar({
        blur:false,
        overlay:true,
    });
  	//開いているとき
    $('body').on("pushbar_opening", function(){
    	//バウンスの無効化
    	iNoBounce.enable()
		//スワイプ方向定義
	    var hammertime = new Hammer(document.body);
		hammertime.get('swipe').set({ direction: Hammer.DIRECTION_ALL });
	    //スワイプイベント登録
	  	$('body').hammer().on('swipedown', function(){
		    pushbar.close();	
		});
	});
	//閉じているとき
	$('body').on("pushbar_closing", function(){
		//バウンスの有効化
		iNoBounce.disable()
	});
  });
</script>


<script type="text/javascript">
	!function(t,e){"object"==typeof exports?module.exports=e(t):"function"==typeof define&&define.amd?define([],e(t)):t.LazyLoad=e(t)}("undefined"!=typeof global?global:this.window||this.global,function(t){"use strict";function e(t,e){this.settings=r(s,e||{}),this.images=t||document.querySelectorAll(this.settings.selector),this.observer=null,this.init()}const s={src:"data-src",srcset:"data-srcset",selector:".lazyload"},r=function(){let t={},e=!1,s=0,o=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],s++);for(;s<o;s++)!function(s){for(let o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e&&"[object Object]"===Object.prototype.toString.call(s[o])?t[o]=r(!0,t[o],s[o]):t[o]=s[o])}(arguments[s]);return t};if(e.prototype={init:function(){if(!t.IntersectionObserver)return void this.loadImages();let e=this,s={root:null,rootMargin:"0px",threshold:[0]};this.observer=new IntersectionObserver(function(t){t.forEach(function(t){if(t.intersectionRatio>0){e.observer.unobserve(t.target);let s=t.target.getAttribute(e.settings.src),r=t.target.getAttribute(e.settings.srcset);"img"===t.target.tagName.toLowerCase()?(s&&(t.target.src=s),r&&(t.target.srcset=r)):t.target.style.backgroundImage="url("+s+")"}})},s),this.images.forEach(function(t){e.observer.observe(t)})},loadAndDestroy:function(){this.settings&&(this.loadImages(),this.destroy())},loadImages:function(){if(!this.settings)return;let t=this;this.images.forEach(function(e){let s=e.getAttribute(t.settings.src),r=e.getAttribute(t.settings.srcset);"img"===e.tagName.toLowerCase()?(s&&(e.src=s),r&&(e.srcset=r)):e.style.backgroundImage="url("+s+")"})},destroy:function(){this.settings&&(this.observer.disconnect(),this.settings=null)}},t.lazyload=function(t,s){return new e(t,s)},t.jQuery){const s=t.jQuery;s.fn.lazyload=function(t){return t=t||{},t.attribute=t.attribute||"data-src",new e(s.makeArray(this),t),this}}return e});
</script>
<script type="text/javascript" charset="utf-8">
$(function() {
    $('img.lazyload').lazyload({ 
    	container: $('#ggg'),
        effect : 'fadeIn'
    });
    $('img.lazyload').lazyload({ 
    	container: $('#hhh'),
        effect : 'fadeIn'
    });
});
</script>